<template>
  <div>
    <el-dialog
      :visible.sync="show"
      width="50%"
      append-to-body
      destroy-on-close
    >
      <div style="padding: 0 36px 0 0">
        <div>
          <el-input
            placeholder="请输入组名"
            v-model="name"
            clearable
            size="small"
            style="width: 240px; margin-right: 24px"
          ></el-input>
          <el-button @click="getList" class="button" type="primary" size="small"
            >查询</el-button
          >
        </div>
        <el-table :data="tableData" class="table">
          <el-table-column prop="id" label="ID" width="55" />

          <el-table-column prop="name" label="组名"> </el-table-column>
          <el-table-column prop="mode" label="模式">
            <template slot-scope="scope">
              {{ ["随机", "组合"][scope.row.mode] }}
            </template>
          </el-table-column>
          <el-table-column prop="enable" label="状态">
            <template slot-scope="scope">
              <el-switch
                active-color="#13ce66"
                inactive-color="#ff4949"
                active-text="开"
                inactive-text="关"
                v-model="scope.row.enable"
                disabled
              >
              </el-switch>
            </template>
          </el-table-column>

          <!-- <el-table-column prop="created_time" label="创建日期">
            <template slot-scope="scope">
              {{ getTime(scope.row.created_time) }}
            </template>
          </el-table-column> -->
          <el-table-column label="操作" width="50" align="center" fixed="right">
            <template slot-scope="scope">
              <div class="flex-cb">
                <el-button size="mini" type="text" @click="selectId(scope.row)"
                  >选择</el-button
                >
              </div>
            </template>
          </el-table-column>
        </el-table>
        <el-pagination
          class="tr"
          small
          hide-on-single-page
          @size-change="handleSizeChange"
          @current-change="handleCurrentChange"
          :current-page.sync="page"
          :page-sizes="[10, 20, 50]"
          :page-size="page_num"
          layout="total, prev, pager, next"
          :total="total"
        />
      </div>
    </el-dialog>

    <el-button size="small" @click="open">
      <div v-if="info.id">{{info.name}} - {{info.id}}</div>
      <div v-else>请选择</div>
    </el-button>
  </div>
</template>

<script>
import { get, del, update, add } from "@/api/sayHelloGroup";

export default {
  props: ["value", "groupName"],
  components: {},
  data() {
    return {
      show: false,
      tableData: [],
      info: {}, // 选择的组信息
      name: "",
      page: 1,
      page_num: 5,
      total: 0,
    };
  },
  computed: {},
  created() {
    this.info = { id: this.value, name: this.groupName };
  },
  mounted() {},
  methods: {
    handleSizeChange(page_num) {
      this.page_num = page_num;
      this.getList();
    },
    handleCurrentChange(page) {
      this.page = page;
      this.getList();
    },
    async open(info) {
      console.log(1223, this.value, this.groupName);
      // this.info = info;
      await this.getList();
      this.show = true;
    },
    close() {
      this.show = false;
    },
    selectId(row) {
      console.log(12, row);
      this.info = row;
      this.$emit("input", row.id);
      this.$emit("confirm", row);
      this.close();
    },
    /**
     * 表格数据获取
     */
    async getList() {
      const { data = [], total } = await get({
        page: this.page,
        page_num: this.page_num,
        name: this.name,
        valid: true,
      });
      this.tableData = data;
      this.total = total;
    },
  },
};
</script>































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































/* @import url(); 引入css类 */































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































</style>
